'use strict';

const Joi = require('joi');
const buildSchema = require('./../build-schema');
const common = require('../common');

const baseFields = {
  id: common.id,
  whitelabel: common.whitelabel,
  name: common.name.allow(""),
  slug: common.slug,
  description: common.description,
  email: common.email,
  password: common.password,
  phone: common.phone,
  otp_secret: Joi.string().max(255),
  facebook_id: Joi.string().max(255),
  google_id: Joi.string().max(255),
  twitter_id: Joi.string().max(255),
  payoneer_id: Joi.string().max(255),
  payoneer_payee_id: Joi.string().max(255),
  payoneer_signup_url: Joi.string(),
  payoneer_card_signup_status: Joi.string().max(255),
  payoneer_method: Joi.number().integer(),
  commission_type: Joi.number().integer(),
  commission_rate: Joi.number().integer(),
  given_name: Joi.string().max(255).allow(""),
  family_name: Joi.string().max(255).allow(""),
  date_of_birth: Joi.date().iso(),
  gender: Joi.string().valid('m', 'f', 'o', ''),
  lang: common.lang,
  region: common.region,
  currency: common.currency,
  program_referrer: common.id,
  sales_referrer: common.id,
  user_referrer: common.id,
  email_bounced: Joi.number().integer().max(1),
  active: common.active,
  regionChanged : common.regionChanged,
  newsLetterFollowed:common.newsLetterFollowed,
  link_hash: Joi.string().max(40),
  last_pw_updated_date: Joi.string(),
  card_pan_id: Joi.string()
};

const requiredForPost = ['whitelabel'];

const attributeFields = {
  twitter_screen_name: Joi.string().max(255),
  paypal_id: Joi.string().max(255),
  stripe_account_id: Joi.string().max(255),
  stripe_customer_id: Joi.string().max(255)
};

const additionalForbiddenAttribs = ['email_address', 'phone_number'];

module.exports = buildSchema(baseFields, requiredForPost, attributeFields, additionalForbiddenAttribs);
