'use strict';

const Joi = require('joi');
const common = require('../common');

const baseFields = {
  id: common.id,
  user_id: common.id,
  name: common.name,
  description: common.description,
  gateway: common.gateway,
  to_currency: common.currency,
  from_currencies: Joi.string().max(255),
  amount: Joi.number().integer().min(1).max(9999999999),
  state: Joi.string().valid('initiated', 'approved', 'rejected', 'complete', 'failed'),
  date_initiated: Joi.date().iso(),
  date_rejected: Joi.date().iso(),
  date_approved: Joi.date().iso()
};

let post = baseFields;
// Tweak for posts
post.id = Joi.forbidden();
post.user_id = post.user_id.required();
post.gateway = post.gateway.required();
post.amount = post.amount.required();
post.to_currency = post.to_currency.required();
post.state = post.state.required();

let patch = baseFields;
patch.user_id = patch.user_id.optional();
patch.gateway = patch.gateway.optional();
patch.to_currency = patch.to_currency.optional();
patch.state = patch.state.optional();


module.exports = {
  incomingPost: Joi.object().keys(post).unknown(true),
  incomingPatch: Joi.object().keys(patch).unknown(true),
  columns: Object.keys(baseFields),
  forbiddenAttributes: []
};