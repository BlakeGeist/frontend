'use strict';

const Joi = require('joi');
const buildSchema = require('./../build-schema');
const common = require('../common');

const baseFields = {
  id: common.id,
  user_id: common.id,
  name: common.name,
  slug: common.slug,
  description: common.description,
  type: Joi.string().max(255),
  direction: Joi.string().valid('in', 'out', 'all'),
  gateway: common.gateway,
  gateway_id: Joi.string().max(255),
  currency: common.currency,
  active: common.active
};

const requiredForPost = [];

const attributeFields = {
  // attribs for multiple payment method types
  last4: Joi.string().description('Last 4 digits of either a credit card, debit card, or bank account number'),

  // attribs for credit cards
  brand: Joi.string().description('Credit card issuer, e.g. visa or mastercard'),
  funding: Joi.string().description('Funding type of the credit card, e.g. credit or prepaid'),
  exp_month: Joi.string().description('Expiration month of the credit card'),
  exp_year: Joi.string().description('Expiration year of the credit card'),
  address_line1: Joi.string(),
  address_line2: Joi.string(),
  address_city: Joi.string(),
  address_state: Joi.string(),
  address_zip: Joi.string(),
  address_country: Joi.string(),

  // attribs for bank accounts
  bank_name: Joi.string().description('Optional name of a bank account for display purposes'),
  country: Joi.string().description('Country where the bank account originates'),

  // attribs for tokenized payment methods such as apple pay
  dynamic_last4: Joi.string(),
  tokenization_method: Joi.string()
};

const additionalForbiddenAttribs = [];

module.exports = buildSchema(baseFields, requiredForPost, attributeFields, additionalForbiddenAttribs);
